(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["SearchResultsPage"],{

/***/ "./homepage/frontend/src/actions/search.js":
/*!*************************************************!*\
  !*** ./homepage/frontend/src/actions/search.js ***!
  \*************************************************/
/*! exports provided: getSearchResults, getQuestionForAnswer, reset */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSearchResults\", function() { return getSearchResults; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getQuestionForAnswer\", function() { return getQuestionForAnswer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"reset\", function() { return reset; });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./types */ \"./homepage/frontend/src/actions/types.js\");\n\n // get search results\n\nvar getSearchResults = function getSearchResults(searchQuery) {\n  return function (dispatch) {\n    axios__WEBPACK_IMPORTED_MODULE_0___default.a.get(\"/api/search\", {\n      params: {\n        query: searchQuery\n      }\n    }).then(function (res) {\n      dispatch({\n        type: _types__WEBPACK_IMPORTED_MODULE_1__[\"GET_SEARCH_RESULTS\"],\n        payload: res.data\n      });\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    });\n  };\n};\nvar getQuestionForAnswer = function getQuestionForAnswer(id, answerID) {\n  return function (dispatch) {\n    axios__WEBPACK_IMPORTED_MODULE_0___default.a.get(\"/api/questions/\".concat(id)).then(function (res) {\n      dispatch({\n        type: _types__WEBPACK_IMPORTED_MODULE_1__[\"GET_QUESTION_FOR_ANSWER\"],\n        payload: res.data,\n        id: answerID\n      });\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  };\n};\nvar reset = function reset() {\n  return function (dispatch) {\n    dispatch({\n      type: _types__WEBPACK_IMPORTED_MODULE_1__[\"RESET_RESULTS\"]\n    });\n  };\n};\n\n//# sourceURL=webpack:///./homepage/frontend/src/actions/search.js?");

/***/ }),

/***/ "./homepage/frontend/src/components/misc/SearchResultsPage.js":
/*!********************************************************************!*\
  !*** ./homepage/frontend/src/components/misc/SearchResultsPage.js ***!
  \********************************************************************/
/*! exports provided: SearchResultsPage, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SearchResultsPage\", function() { return SearchResultsPage; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/index.js\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/es/index.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router-dom/esm/react-router-dom.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! prop-types */ \"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _actions_search__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../actions/search */ \"./homepage/frontend/src/actions/search.js\");\n/* harmony import */ var _actions_questions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../actions/questions */ \"./homepage/frontend/src/actions/questions.js\");\n/* harmony import */ var _actions_tags__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../actions/tags */ \"./homepage/frontend/src/actions/tags.js\");\n/* harmony import */ var _questions_QuestionCard__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../questions/QuestionCard */ \"./homepage/frontend/src/components/questions/QuestionCard.js\");\n/* harmony import */ var _actions_types__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../actions/types */ \"./homepage/frontend/src/actions/types.js\");\n/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../store */ \"./homepage/frontend/src/store.js\");\n/* harmony import */ var _setTagInQuestionCard__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./setTagInQuestionCard */ \"./homepage/frontend/src/components/misc/setTagInQuestionCard.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar SearchResultsPage = /*#__PURE__*/function (_Component) {\n  _inherits(SearchResultsPage, _Component);\n\n  function SearchResultsPage(props) {\n    var _this;\n\n    _classCallCheck(this, SearchResultsPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SearchResultsPage).call(this, props));\n\n    _this.handleSearch = function () {\n      _this.props.getSearchResults(_this.props.location.state.searchQuery);\n\n      _this.setState({\n        searchQuery: _this.props.location.state.searchQuery,\n        searchMade: true\n      });\n    };\n\n    _this.fillTopicTags = function (question) {\n      var topicTagNames = [];\n      question.topic_tags.map(function (tag) {\n        return topicTagNames.push(_this.props.topicTags[tag]);\n      });\n      return topicTagNames;\n    };\n\n    _this.state = {\n      isLoading: true,\n      searchQuery: '',\n      searchResults: [],\n      resultsID: [],\n      redirectTo: '',\n      reset: true,\n      searchMade: false\n    };\n    _store__WEBPACK_IMPORTED_MODULE_10__[\"default\"].dispatch({\n      type: _actions_types__WEBPACK_IMPORTED_MODULE_9__[\"RESET_RESULTS\"]\n    });\n    return _this;\n  }\n\n  _createClass(SearchResultsPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (Object.entries(this.props.electionTags).length == 0) Object(_actions_tags__WEBPACK_IMPORTED_MODULE_7__[\"getAllTags\"])('election');\n      if (Object.entries(this.props.topicTags).length == 0) Object(_actions_tags__WEBPACK_IMPORTED_MODULE_7__[\"getAllTags\"])('topic');\n      this.handleSearch();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this2 = this;\n\n      if (prevProps.location.state.searchQuery != this.props.location.state.searchQuery && this.props.results != null && !this.state.reset) {\n        this.props.reset();\n        this.setState({\n          reset: true\n        });\n      }\n\n      if (this.state.reset && !this.state.searchMade) {\n        this.handleSearch();\n      }\n\n      if (this.state.searchMade && this.props.results != null) {\n        var needToWait = false;\n\n        if (Object.keys(this.props.results).length > 0) {\n          var resultsID = [];\n          this.props.results.questions.map(function (question) {\n            resultsID.push(question.id);\n\n            _this2.props.getAnswers(question.id);\n          });\n          var count = 0;\n          this.props.results.answers.map(function (answer) {\n            if (!resultsID.includes(answer.question)) {\n              _this2.props.getQuestionForAnswer(answer.question, count);\n\n              needToWait = true;\n            }\n\n            count += 1;\n          });\n        }\n\n        this.setState({\n          searchResults: this.props.results.questions,\n          resultsID: resultsID,\n          isLoading: needToWait,\n          reset: false,\n          searchMade: false\n        });\n      }\n\n      if (prevProps.questionsForRelevantAnswers != this.props.questionsForRelevantAnswers) {\n        var results = this.state.searchResults;\n        var resultsID = this.state.resultsID;\n\n        if (this.props.questionsForRelevantAnswers != null) {\n          Object.values(this.props.questionsForRelevantAnswers).map(function (question) {\n            if (!_this2.state.resultsID.includes(question.id)) {\n              results.push(question);\n              resultsID.push(question.id);\n\n              _this2.props.getAnswers(question.id);\n            }\n          });\n        }\n\n        this.setState({\n          searchResults: results,\n          resultsID: resultsID,\n          isLoading: false,\n          reset: false\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.redirectTo != '') {\n        return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_3__[\"Redirect\"], {\n          to: this.state.redirectTo\n        });\n      }\n\n      var toRender = this.state.isLoading ? react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"Spinner\"], {\n        animation: \"border\"\n      }) : react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"h1\", null, \"Your Search Results\"), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"ul\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"li\", null, \"Search: \\\"\", this.state.searchQuery, \"\\\"\"), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"li\", null, \"Count: \", this.state.searchResults.length)), this.state.searchResults.length > 0 ? this.state.searchResults.map(function (question) {\n        return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_questions_QuestionCard__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n          key: question.id,\n          content: question.content,\n          answers: _this3.props.answers[question.id] == null ? [] : _this3.props.answers[question.id],\n          election_tag: Object.entries(_this3.props.electionTags).length > 0 ? _this3.props.electionTags[question.election_tag] : '',\n          topic_tags: Object.entries(_this3.props.topicTags).length > 0 ? _this3.fillTopicTags(question) : [],\n          election_tag_id: question.election_tag,\n          topic_tag_ids: question.topic_tags,\n          upvotes: question.upvotes,\n          id: question.id,\n          created_by_username: question.created_by_username,\n          searchQuery: _this3.state.searchQuery,\n          getAnswers: _this3.props.getAnswers,\n          setTag: _setTagInQuestionCard__WEBPACK_IMPORTED_MODULE_11__[\"default\"],\n          redirectToHome: true\n        });\n      }) : react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"Alert\"], {\n        variant: \"danger\",\n        style: {\n          width: 'fit-content',\n          borderRadius: '25px'\n        }\n      }, \"No results found\"));\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        style: {\n          margin: \"20px 0px 0px 20px\"\n        }\n      }, toRender);\n    }\n  }]);\n\n  return SearchResultsPage;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]);\nSearchResultsPage.propTypes = {\n  getSearchResults: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  results: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.object,\n  questionsForRelevantAnswers: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.object,\n  electionTags: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.object,\n  topicTags: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.object\n};\nSearchResultsPage.defaultProps = {\n  results: null,\n  electionTags: {},\n  topicTags: {}\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    results: state.search.results,\n    questionsForRelevantAnswers: state.search.questionsForAnswers,\n    electionTags: state.tags.electionTags,\n    topicTags: state.tags.topicTags,\n    answers: state.questions.answers\n  };\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(react_router_dom__WEBPACK_IMPORTED_MODULE_3__[\"withRouter\"])(Object(react_redux__WEBPACK_IMPORTED_MODULE_2__[\"connect\"])(mapStateToProps, {\n  getSearchResults: _actions_search__WEBPACK_IMPORTED_MODULE_5__[\"getSearchResults\"],\n  getQuestionForAnswer: _actions_search__WEBPACK_IMPORTED_MODULE_5__[\"getQuestionForAnswer\"],\n  getAnswers: _actions_questions__WEBPACK_IMPORTED_MODULE_6__[\"getAnswers\"],\n  getAllTags: _actions_tags__WEBPACK_IMPORTED_MODULE_7__[\"getAllTags\"],\n  setElectionTags: _actions_tags__WEBPACK_IMPORTED_MODULE_7__[\"setElectionTags\"],\n  setTopicTags: _actions_tags__WEBPACK_IMPORTED_MODULE_7__[\"setTopicTags\"],\n  reset: _actions_search__WEBPACK_IMPORTED_MODULE_5__[\"reset\"]\n})(SearchResultsPage)));\n\n//# sourceURL=webpack:///./homepage/frontend/src/components/misc/SearchResultsPage.js?");

/***/ })

}]);